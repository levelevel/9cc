# 9cc
低レイヤを知りたい人のためのCコンパイラ作成入門

https://www.sigbus.info/compilerbook/

# 目標

**セルフコンパイル**

## セルフコンパイルに向けたTODOリスト

前提条件として、現在コード中に用いている記述は変更しない。コンパイルを通すためにあえて使用する構文を制限することもしない。ただし実装しなくても動作するもの（constなど）はあえて実装しなくてもよいものとする。

- ステップ26：コメント（プリプロセッサを通せばそこで処理される？）
- *配列の初期値（コンマリスト）*
- 多次元配列
- \による文字のエスケープ
- case文
- continue
- break
- goto（多重ループから抜けるために使っているけど、コードを書き直してもよい）
- enum
- long
- void型のポインタ
- 三項演算子
- 複合代入（+=など）
- 関数の戻り値のvoid（int扱いでもたぶんOK）
- グローバル変数のextern宣言
- 関数の宣言（引数の情報は使わない：たぶんOK）
- コンマリストによる複数変数の定義・宣言
- **構造体の実装**
  - .
  - ->
  - メンバのアラインメント
  - 初期値
  - 配列の初期値（構造体）
- typedef
- 型キャスト
- プリプロセッサを通す
- セルフコンパイル用に最低限のヘッダファイルを用意する
- 可変長引数を使用した関数定義（詳細不明）
- ブロック内ローカル変数：for(int i;;)の対応

## 無視する構文要素

コードで使用しているが、影響がない（少ない）のでコンパイル時に読み飛ばすもの。

- 関数のstatic宣言
- グローバル変数のstatic宣言（ローカル変数のstatic宣言は無視できないが未使用）
- 変数・ポインタのconst宣言
- 関数宣言
- 引数リストのvoid
- 関数の引数の型チェック
- 関数の戻り値の型チェック（常に64bitで返せは問題ないはず）

## その他、制限事項・バグなど

- グローバル変数の char*p=buf+1; が未実装。
- ステップ27: テストをCで書き直す
- 変数のアラインメントを考慮していない。
- 関数の引数は型も個数もチェックしていない。
- 関数の戻り値の型はチェックしていない（int固定）。
- 文字列リテラルの途中に明示的な'\0'があると以降が無視される。
- ローカル変数の初期値として文字列リテラルを指定すると.dataにコピーが作られ、実行時にそこからコピーする動作になっている。
